@model List<WorldLib.Models.Comment>

<div class="container">
    <div class="well">
        <div id="modDialog" class="modal fade">
            <div id="dialogContent" class="modal-dialog"></div>
        </div>
        <table class="table table-hover table-bordered">
            <thead>
            <tr>
                <td><strong>ID</strong></td>
                <td><strong>Текст комментария</strong></td>
                <td><strong>Автор</strong></td>
                <td><strong>Дата/время</strong></td>
                <td><strong>Тема обсуждения</strong></td>
                <td></td>
            </tr>
            </thead>

            @foreach (var item in Model)
            {
                <tr>
                    <td>@item.Id</td>
                   @if (item.Status == WorldLib.Enums.CommentStatusEnum.Published)
                   {
                    <td class="text-success">@item.Text</td>
                   }
                   else
                   {
                    <td class="text-danger">@item.Text</td>
                   }
                    <td>@item.User.Email</td>
                    <td>@item.CreationDateTime.ToShortDateString() @item.CreationDateTime.ToShortTimeString()</td>
                    <td>@item.Discussion.Name</td>
                    <td><a class="item-category" href="~/Comments/Edit/@item.Id"><span class="glyphicon glyphicon-edit"></span></a></td>
                    <td><a href="~/Comments/Delete/?id=@item.Id&email=@item.User.Email"><span class="glyphicon glyphicon-remove text-danger"></span></a></td>
                    @if (item.Status == WorldLib.Enums.CommentStatusEnum.Moderation)
                    {
                        <td><a href="~/Comments/PublishedComment/@item.Id"><strong class="text-success">опубликовать</strong></a></td>
                    }
                    else
                    {
                        <td><strong class="text-muted">опубликован</strong></td>
                    }

                </tr>
            }

        </table>
    </div>
</div>

@section scripts
{
    <script type="text/javascript">
        $(function () {
            $.ajaxSetup({ cache: false });
            $(".item-category").click(function (e) {
                e.preventDefault();
                $.get(this.href, function (data) {
                    $('#dialogContent').html(data);
                    $('#modDialog').modal('show');
                });
            });
        })
    </script>
}

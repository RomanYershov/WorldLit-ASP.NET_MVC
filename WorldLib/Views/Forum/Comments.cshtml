@using System.Web.UI.WebControls
@using WebGrease.Css.Extensions
@using WorldLib.Models
@model CommentsByDiscussionViewModel
@{
    ViewBag.Title = "Comments";
}

<div class="container">
    <div class="panel panel-primary" style="border:none" id="panel-container">
        <div class="panel-heading text-center" onclick="blockClick()" id="block-disc">

            @if (Model.Discussion != null)
            {
                <h4>@Model.Discussion.Name</h4>

            }
            else
            {
                <h4>В этом обсуждении пока отсутствуют комментарии ..</h4>
            }

        </div>
        <div class="panel-body">
            <div class="row">
                <div class="col-md-12">
                    @foreach (var comment in Model.Comments)
                    {
                        <div id="results" style="margin-bottom:1px;background-color:  #edf0333d" class="alert-success alert ">
                            <span  class="text-success">@comment.Text</span> 
                           <div style="padding:8px 0 5px 14px">
                               <small style="float:right;" class=" text-muted">@comment.User.NikName</small>
                               <small style="float:left;" class="text-muted">@string.Format(" {0} ~ {1} ", comment.CreationDateTime.ToLongDateString(), comment.CreationDateTime.ToShortTimeString())</small>
                           </div>
                        </div>
                    }

                    @if (User.Identity.IsAuthenticated)
                    {
                        using (Ajax.BeginForm("AddComment", new AjaxOptions { LoadingElementId = "results",
                        InsertionMode = InsertionMode.InsertAfter}))
                        {
                            @Html.TextArea("Text", new {cols=50, rows=7});
                            @Html.Hidden("DiscussionId", Model.Discussion.Id);
                            <input class="btn btn-block btn-info" type="submit" value="добавить" />
                            //<input type="hidden" name="Discussion" value="@Model.Discussion" />
                        }
                    }
                </div>
                @*<div class="col-md-4 text-center">
                        @{Html.RenderPartial("CategoriesPartialView", ViewBag.CategoriesList as List<Category>);}
                    </div>*@
            </div>
        </div>

    </div>
</div>


@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}

<script>
    var block = document.getElementById('block-disc');
    function blockClick() {
        window.location.href = "../../Forum/Index";
    }
</script>

<style>
    #block-disc {
        background-color: #00796B;
        cursor: pointer;
        color: darkgray;
    }

        #block-disc:hover {
            /*background-color:#777;*/
            color: white;
            /*box-shadow: 0px 15px 10px -15px #111;*/
        }
    /*#panel-container {
        box-shadow: -15px 0px 5px -15px #111;
    }*/
</style>




